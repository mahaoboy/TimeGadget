<?xml version="1.0" encoding="UTF-8" ?><Module><ModulePrefs title="Time Gadge" directory_title="Time Gadge" description="Time Gadge" author="winagile" author_affiliation="winagile" author_location="Beijing, China" title_url="http://www.winagile.com/" screenshot='http://www.google.com/gadgets/directory/2661487601-no_preview.gif' thumbnail='http://www.google.com/gadgets/directory/348515928-no_image_gadget_thm.png'><Optional feature="gadget-directory"><Param name="categories">JIRA
				Charts
			</Param></Optional><Require feature="dynamic-height"/><Require feature="settitle"/><Require feature="setprefs"/><Optional feature="atlassian.util"/><Require feature="settitle"/>
		#supportedLocales("gadget.common")
	</ModulePrefs><UserPref name="project_or_custom" display_name="Project Or Component(Custom Field)?" datatype="list" default_value="proj|cust"/><UserPref name="custom_for_col" display_name="Component(Custom Field)"/><UserPref name="issuen_or_custom" display_name="Issue Number Or Date Time(Custom Field)?" datatype="list" default_value="issueNum|cust"/><UserPref name="custom_for_row" display_name="Custom Field List"/><Content type="html" view="profile,canvas,home">
  <![CDATA[
  		#requireContext("com.atlassian.jira.gadgets:autocomplete")
        #requireResource("com.atlassian.gadgets.publisher:ajs-gadgets")
        #includeResources()
        <div id="intro-content" class="fullyCentered"><div class="fullyCentered" style="background:#fff url('__ATLASSIAN_BASE_URL__/images/icons/wait.gif') 95% center no-repeat;heitght:20px;width:20px;"><img src="" style="display:none" /></div></div>
        <script type="text/javascript">
            jQuery.namespace("winagile.app.gadget");
            winagile.app.gadget = function(){
                function response(resp){
                    var resize = function(){gadgets.window.adjustHeight();};
                    if (resp.rc != 200){
                        AJS.log("Error on server call '__ATLASSIAN_BASE_URL__/rest/myrestresource/1.0/message'.  Return code: " + resp.rc);
                        return;
                    }
                    if (resp.data.value){
                        jQuery("#intro-content > div").css("background","");
                        jQuery("#intro-content > div").css("height","");
                        jQuery("#intro-content > div").css("width","");
                        jQuery("#intro-content > div > img").attr("src", "__ATLASSIAN_BASE_URL__/charts?filename="+resp.data.value).css("display", "block");
                    }
                    resize();
                }
                
               var width = Math.round(gadgets.window.getViewportDimensions().width * 0.9);
			   var height = Math.round(gadgets.window.getViewportDimensions().height * 0.9);
               if (width < 150){
                   width = 150;
                   height = Math.round(width*2/3)
               }
 
                return function(){
                    var params = {};
                    params[gadgets.io.RequestParameters.CONTENT_TYPE] = gadgets.io.ContentType.JSON;
                    params[gadgets.io.RequestParameters.METHOD] = gadgets.io.MethodType.GET;
                    gadgets.io.makeRequest("__ATLASSIAN_BASE_URL__/rest/myrestresource/1.0/message?widthName="+width+"&heightName="+height, response, params);
 
                };
            }();
            gadgets.util.registerOnLoadHandler(winagile.app.gadget);
        </script>
 
 
  ]]>
	</Content></Module>